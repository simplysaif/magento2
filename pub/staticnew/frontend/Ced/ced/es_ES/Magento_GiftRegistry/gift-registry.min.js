define(['jquery','Magento_Theme/js/row-builder','jquery/ui'],function($,rowBuilder){'use strict';$.widget('mage.giftRegistry',rowBuilder,{options:{rowIdPrefix:'registrant:',rowCustomIdPrefix:'registrant:custom:',addrTypeSelector:'#address_type_or_id',newShipAddrFormSelector:'#shipping-new-address-form',shipAddrDataSelector:'div[data-shipping-address]',shipAddrDataAttr:'shipping-address',newAddrTypeVal:'new'},_create:function(){this._super();if($(this.options.shipAddrDataSelector).data(this.options.shipAddrDataAttr)){$(this.options.addrTypeSelector).val(this.options.newAddrTypeVal);$(this.options.newShipAddrFormSelector).show();}
this.element.on('change',this.options.addrTypeSelector,$.proxy(this._handleShipAddrChange,this));},processFormDataArr:function(formDataArr){var formData=formDataArr.formData,i;for(i=this.options.rowIndex=0;i<formData.length;this.options.rowIndex=i++){this.addRow(i);this._processFormDataArrKey(i,formData[i],false);}},_processFormDataArrKey:function(index,formRow,isCustom){var idPrefix=isCustom?this.options.rowCustomIdPrefix:this.options.rowIdPrefix,key;for(key in formRow){if(formRow.hasOwnProperty(key)){if(Object.prototype.toString.call(formRow[key])==='[object Object]'){this._processFormDataArrKey(index,formRow[key],true);}else{this.setFieldById(idPrefix+key+index,formRow[key]);}}}},_handleShipAddrChange:function(e){$(this.options.newShipAddrFormSelector).toggle(e.target.value===this.options.newAddrTypeVal);}});return $.mage.giftRegistry;});