(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','mage/mage'],factory);}else{factory(jQuery);}}(function($){'use strict';$.mage.Webapi=function(baseUrl,ajaxArgs){var validMethods;this.resource={uri:{base:'',api:'/webapi/rest'}};this.method={'create':'POST','update':'PUT','get':'GET','delete':'DELETE'};validMethods=[this.method.create,this.method.update,this.method.get,this.method['delete']];if(ajaxArgs&&typeof ajaxArgs!=='object'){throw'ajaxArgs expected to be object';}
if(!(baseUrl&&typeof baseUrl==='string')){throw'String baseUrl parameter required';}
this.resource.uri.base=baseUrl[baseUrl.length-1]==='/'?baseUrl.substr(0,baseUrl.length-1):baseUrl;this.call=function(resourceUri,method,data,version){var that=this,ajaxOptions;function validateMethod(methodName){if(validMethods.indexOf(methodName)===-1){throw'Method name is not valid: '+methodName;}
return methodName;}
function getUrl(resUri,m,payload,v){function ensureForwardSlash(str){return str[0]==='/'?str:'/'+str;}
if(v){resUri=v+ensureForwardSlash(resUri);}
if(payload&&[that.method.get,that.method['delete']].indexOf(m)!==-1){resUri+=payload;}
return that.resource.uri.base+that.resource.uri.api+ensureForwardSlash(resUri);}
ajaxOptions={url:getUrl(resourceUri,method,data,version),type:validateMethod(method),data:data,dataType:'text',timeout:5000,processData:false,cache:false,beforeSend:function(request){request.setRequestHeader('Accept','application/json');}};$.extend(ajaxOptions,ajaxArgs);return $.ajax(ajaxOptions);};return this;};$.mage.Webapi.prototype.constructor=$.mage.Webapi;$.mage.Webapi.prototype.Product=function(version){var that=this;if(!(typeof version==='string'&&/v\d+/i.test(version))){throw'Incorrect version format: '+version;}
version=version.toLowerCase();that.resource.uri.products='/products/';return{get:function(idObj){if(!idObj.hasOwnProperty('id')){throw'"id" property expected in the object';}
return that.call(that.resource.uri.products,that.method.get,idObj.id,version);},create:function(productData){return that.call(that.resource.uri.products,that.method.create,productData,version);}};};}));