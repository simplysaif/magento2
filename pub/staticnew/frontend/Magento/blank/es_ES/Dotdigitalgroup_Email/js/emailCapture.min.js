define(['jquery','domReady!'],function($){'use strict';function validateEmail(sEmail){var filter=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;return filter.test(sEmail);}
function emailCaptureCheckout(url){var previousEmail='';$('body').on('blur','input[id=customer-email]',function(){var email=$(this).val();if(email===previousEmail){return false;}
if(email&&validateEmail(email)){previousEmail=email;$.post(url,{email:email});}});}
function emailCaptureNewsletter(url){$('input[id=newsletter]').each(function(index,element){$(element).on('blur',function(){var email=$(element).val();if(email&&validateEmail(email)){$.post(url,{email:email});}});});}
return function(emailCapture){if(emailCapture.type==='checkout'){emailCaptureCheckout(emailCapture.url);}
if(emailCapture.type==='newsletter'){emailCaptureNewsletter(emailCapture.url);}};});